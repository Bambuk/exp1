# Промт для работы с sync_tracker и оптимизацией полей API

## КОНТЕКСТ:
- Проект: Radiator - система синхронизации данных из Yandex Tracker
- Текущее состояние: sync_tracker загружает все поля задач из API
- Цель: Оптимизировать загрузку данных и сохранить все поля для последующего использования

## ТЕКУЩАЯ АРХИТЕКТУРА:
- Файл: radiator/commands/sync_tracker.py (825 строк)
- Модель: radiator/models/tracker.py (таблица tracker_tasks)
- API сервис: radiator/services/tracker_service.py
- Документация: docs/guides/TRACKER_SYNC_README.md

## ДОСТУПНЫЕ РЕСУРСЫ:
- Файл полей: data/config/fields.txt (41 поле, включая customer)
- Скрипт анализа: scripts/analyze_tracker_fields.py
- API поддерживает параметр 'fields' для выборочной загрузки полей
- API поддерживает параметр 'expand=links,comments' для расширенных данных

## ЗАДАЧА:
1. Модифицировать sync_tracker для использования параметра 'fields' при запросах к API
2. Добавить поле 'customer' в таблицу tracker_tasks
3. Добавить JSONB поле 'full_data' в таблицу tracker_tasks для хранения всех полей задачи
4. Сохранять полные данные задач в JSONB поле при синхронизации
5. Создать методы для извлечения данных из JSONB поля без обращения к API

## ТЕХНИЧЕСКИЕ ТРЕБОВАНИЯ:
- Использовать Alembic для миграции БД
- Сохранить обратную совместимость
- Добавить индексы GIN для быстрого поиска по JSONB
- Обновить TrackerService для поддержки параметра fields
- Обновить модели данных

## ОЖИДАЕМЫЙ РЕЗУЛЬТАТ:
- Ускорение API запросов за счёт загрузки только нужных полей
- Сохранение всех данных задач локально
- Возможность работы с полными данными без повторных запросов к API
- Снижение нагрузки на API Tracker

## ФАЙЛЫ ДЛЯ ИЗМЕНЕНИЯ:
- radiator/models/tracker.py
- radiator/commands/sync_tracker.py
- radiator/services/tracker_service.py
- alembic/versions/ (новая миграция)

**Пожалуйста, создай детальный план работ с пошаговыми инструкциями в tdd стиле. после каждого шага необходимо запрашивать подтверждение пользователя о продолжении. если что-то пошл не по плану, также необходимо соглаосвывать изменение плана. начало и завершение работы должно быть обрамлено прогоном всех тестов. минимум самодеятельности, максимум линейности и предсказуемости**
