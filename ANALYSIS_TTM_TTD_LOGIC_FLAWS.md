# –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –∏–∑—ä—è–Ω–æ–≤ –≤ –ø–æ–¥—Å—á–µ—Ç–µ TTM –∏ TTD

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 2025-10-06
**–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º—ã–µ —Ñ–∞–π–ª—ã:**
- `radiator/commands/generate_time_to_market_report.py`
- `radiator/commands/services/metrics_service.py`
- `radiator/commands/services/data_service.py`

---

## üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´

### 1. –†–∞—Å—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –≤ —Ä–∞—Å—á–µ—Ç–µ Pause Time

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `generate_time_to_market_report.py`, —Å—Ç—Ä–æ–∫–∏ 147-191

**–ü—Ä–æ–±–ª–µ–º–∞:**
–í –æ—Å–Ω–æ–≤–Ω–æ–º —Ü–∏–∫–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–¥–∞—á –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ä–∞–∑–Ω—ã–µ –º–µ—Ç–æ–¥—ã –ø–æ–¥—Å—á–µ—Ç–∞ pause time:

```python
# –°—Ç—Ä–æ–∫–∞ 160 –∏ 183 - –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
pause_time = self.metrics_service.calculate_pause_time(history)
# –í—ã—á–∏—Å–ª—è–µ—Ç –ü–û–õ–ù–û–ï –≤—Ä–µ–º—è –ø–∞—É–∑—ã –¥–ª—è –≤—Å–µ–π –∏—Å—Ç–æ—Ä–∏–∏ –∑–∞–¥–∞—á–∏

# –ù–æ –≤ calculate_time_to_delivery (—Å—Ç—Ä–æ–∫–∞ 274 metrics_service.py)
pause_time = self.calculate_pause_time_up_to_date(history_data, target_entry.start_date)
# –í—ã—á–∏—Å–ª—è–µ—Ç pause time –¢–û–õ–¨–ö–û –¥–æ —Ü–µ–ª–µ–≤–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- TTD –≤—ã—á–∏—Ç–∞–µ—Ç –ø–∞—É–∑—ã —Ç–æ–ª—å–∫–æ –¥–æ —Å—Ç–∞—Ç—É—Å–∞ "–ì–æ—Ç–æ–≤–∞ –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ"
- –ù–æ –≤ `ttd_pause_times` —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ü–û–õ–ù–û–ï –≤—Ä–µ–º—è –ø–∞—É–∑—ã, –≤–∫–ª—é—á–∞—è –ø–∞—É–∑—ã –ü–û–°–õ–ï –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–µ–≤–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞
- –≠—Ç–æ –∏—Å–∫–∞–∂–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –ø–∞—É–∑–∞–º (pause_mean, pause_p85)
- –î–∞–Ω–Ω—ã–µ –≤ –æ—Ç—á–µ—Ç–µ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ä–µ–∞–ª—å–Ω—ã–º –≤—ã—á—Ç–µ–Ω–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º

**–ü—Ä–∏–º–µ—Ä:**
```
–ó–∞–¥–∞—á–∞ CPO-123:
- –°–æ–∑–¥–∞–Ω–∞: 2025-01-01
- –ì–æ—Ç–æ–≤–∞ –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ: 2025-01-10 (TTD –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 9 –¥–Ω–µ–π)
- –ü–∞—É–∑–∞ 2025-01-05 –¥–æ 2025-01-08 (3 –¥–Ω—è) - –î–û —Ü–µ–ª–µ–≤–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞
- –ü–∞—É–∑–∞ 2025-01-12 –¥–æ 2025-01-15 (3 –¥–Ω—è) - –ü–û–°–õ–ï —Ü–µ–ª–µ–≤–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞
- Done: 2025-01-20

TTD = 9 - 3 = 6 –¥–Ω–µ–π (–ø—Ä–∞–≤–∏–ª—å–Ω–æ, –≤—ã—á–∏—Ç–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–∞—É–∑–∞ –î–û —Ü–µ–ª–µ–≤–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞)
–ù–æ ttd_pause_times = 6 –¥–Ω–µ–π (–ù–ï–ü–†–ê–í–ò–õ–¨–ù–û! –í–∫–ª—é—á–∞–µ—Ç –æ–±–µ –ø–∞—É–∑—ã)
```

**–†–µ—à–µ–Ω–∏–µ:**
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `calculate_pause_time_up_to_date` –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É:

```python
# –î–ª—è TTD –∑–∞–¥–∞—á (—Å—Ç—Ä–æ–∫–∞ 160):
pause_time = self.metrics_service.calculate_pause_time_up_to_date(
    history,
    # –ù–∞–π—Ç–∏ –¥–∞—Ç—É –ø–µ—Ä–µ—Ö–æ–¥–∞ –≤ "–ì–æ—Ç–æ–≤–∞ –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ"
    next((e.start_date for e in sorted(history, key=lambda x: x.start_date)
          if e.status == "–ì–æ—Ç–æ–≤–∞ –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ"), None)
)

# –î–ª—è TTM –∑–∞–¥–∞—á (—Å—Ç—Ä–æ–∫–∞ 183):
pause_time = self.metrics_service.calculate_pause_time_up_to_date(
    history,
    # –ù–∞–π—Ç–∏ –¥–∞—Ç—É –ø–µ—Ä–≤–æ–≥–æ done —Å—Ç–∞—Ç—É—Å–∞
    next((e.start_date for e in sorted(history, key=lambda x: x.start_date)
          if e.status in status_mapping.done_statuses), None)
)
```

---

### 2. –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø–æ–¥—Å—á–µ—Ç total_tasks

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:**
- `metrics_service.py`, —Å—Ç—Ä–æ–∫–∏ 495, 530
- `time_to_market_models.py`, —Å—Ç—Ä–æ–∫–∏ 100, 129-135

**–ü—Ä–æ–±–ª–µ–º–∞:**
```python
# metrics_service.py, —Å—Ç—Ä–æ–∫–∞ 495 –∏ 530
total_tasks=ttd_metrics.count + ttm_metrics.count,
```

–≠—Ç–æ –ø—Ä–æ—Å—Ç–æ–µ —Å—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ TTD –∏ TTM –º–µ—Ç—Ä–∏–∫, –Ω–æ –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç, —á—Ç–æ:

1. **–û–¥–Ω–∞ –∑–∞–¥–∞—á–∞ –º–æ–∂–µ—Ç –ø–æ–ø–∞—Å—Ç—å –≤ TTD –∏ TTM –¥–ª—è –†–ê–ó–ù–´–• –∫–≤–∞—Ä—Ç–∞–ª–æ–≤:**
   - –ó–∞–¥–∞—á–∞ –ø–µ—Ä–µ—à–ª–∞ –≤ "–ì–æ—Ç–æ–≤–∞ –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ" –≤ Q1 ‚Üí –ø–æ–ø–∞–¥–∞–µ—Ç –≤ ttd_tasks –¥–ª—è Q1
   - –¢–∞ –∂–µ –∑–∞–¥–∞—á–∞ –ø–µ—Ä–µ—à–ª–∞ –≤ "Done" –≤ Q2 ‚Üí –ø–æ–ø–∞–¥–∞–µ—Ç –≤ ttm_tasks –¥–ª—è Q2
   - –†–µ–∑—É–ª—å—Ç–∞—Ç: –∑–∞–¥–∞—á–∞ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –î–í–ê–ñ–î–´ (–æ–¥–∏–Ω —Ä–∞–∑ –≤ Q1, –æ–¥–∏–Ω —Ä–∞–∑ –≤ Q2)

2. **–ó–∞–¥–∞—á–∞ –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –æ–±–µ –º–µ—Ç—Ä–∏–∫–∏ –≤ –æ–¥–Ω–æ–º –∫–≤–∞—Ä—Ç–∞–ª–µ:**
   - –ï—Å–ª–∏ –∑–∞–¥–∞—á–∞ –ø–µ—Ä–µ—à–ª–∞ –≤ "–ì–æ—Ç–æ–≤–∞ –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ" –∏ "Done" –≤ –æ–¥–Ω–æ–º –∫–≤–∞—Ä—Ç–∞–ª–µ
   - –û–Ω–∞ –ø–æ–ø–∞–¥–µ—Ç –∏ –≤ ttd_tasks, –∏ –≤ ttm_tasks –¥–ª—è —ç—Ç–æ–≥–æ –∫–≤–∞—Ä—Ç–∞–ª–∞
   - –†–µ–∑—É–ª—å—Ç–∞—Ç: –∑–∞–¥–∞—á–∞ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –î–í–ê–ñ–î–´ –≤ –æ–¥–Ω–æ–º –∫–≤–∞—Ä—Ç–∞–ª–µ

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- –ò—Å–∫–∞–∂–µ–Ω–∏–µ –æ–±—â–µ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∑–∞–¥–∞—á
- `TimeToMarketReport.total_tasks` (—Å—Ç—Ä–æ–∫–∏ 129-135) —Å—á–∏—Ç–∞–µ—Ç –∑–∞–¥–∞—á–∏ —Å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- –ú–µ—Ç—Ä–∏–∫–∞ `total_tasks` –≤ –æ—Ç—á–µ—Ç–∞—Ö –Ω–µ –æ—Ç—Ä–∞–∂–∞–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á

**–ü—Ä–∏–º–µ—Ä:**
```
Q1 (2025-01-01 –¥–æ 2025-03-31):
  –ó–∞–¥–∞—á–∞ CPO-100: –ø–µ—Ä–µ—à–ª–∞ –≤ "–ì–æ—Ç–æ–≤–∞ –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ" 2025-02-15
  ‚Üí –£—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –≤ ttd_metrics.count = 1

Q2 (2025-04-01 –¥–æ 2025-06-30):
  –ó–∞–¥–∞—á–∞ CPO-100: –ø–µ—Ä–µ—à–ª–∞ –≤ "Done" 2025-05-20
  ‚Üí –£—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –≤ ttm_metrics.count = 1

–ò—Ç–æ–≥–æ: total_tasks = 2, —Ö–æ—Ç—è —ç—Ç–æ –û–î–ù–ê –∑–∞–¥–∞—á–∞!
```

**–†–µ—à–µ–Ω–∏–µ:**

**–í–∞—Ä–∏–∞–Ω—Ç –ê: –ò–∑–º–µ–Ω–∏—Ç—å —Å–µ–º–∞–Ω—Ç–∏–∫—É total_tasks**
```python
# –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ unique_tasks –∏ —Å—á–∏—Ç–∞—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∫–ª—é—á–∏ –∑–∞–¥–∞—á
@dataclass
class GroupMetrics:
    group_name: str
    ttd_metrics: TimeMetrics
    ttm_metrics: TimeMetrics
    tail_metrics: TimeMetrics
    total_metrics: int  # ttd_metrics.count + ttm_metrics.count (–¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)
    unique_tasks: Set[str]  # –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∫–ª—é—á–∏ –∑–∞–¥–∞—á
```

**–í–∞—Ä–∏–∞–Ω—Ç –ë: –û—Ç–¥–µ–ª—å–Ω—ã–π –ø–æ–¥—Å—á–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á –≤ –∫–æ–º–∞–Ω–¥–µ**
```python
# –í generate_time_to_market_report.py –¥–æ–±–∞–≤–∏—Ç—å —Ç—Ä–µ–∫–∏–Ω–≥ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á:
unique_tasks = set()
for task in ttd_tasks:
    unique_tasks.add(task.key)
for task in ttm_tasks:
    unique_tasks.add(task.key)

# –ò –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å —ç—Ç–æ –≤ GroupMetrics
total_unique_tasks=len(unique_tasks)
```

---

### 3. –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –ø–µ—Ä–µ—Ö–æ–¥–∞–º–∏ –≤ –æ–¥–∏–Ω —Å—Ç–∞—Ç—É—Å

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:**
- `metrics_service.py`, —Å—Ç—Ä–æ–∫–∏ 265-268 (TTD)
- `metrics_service.py`, —Å—Ç—Ä–æ–∫–∏ 309-312 (TTM)

**–ü—Ä–æ–±–ª–µ–º–∞:**
```python
# TTD: –Ω–∞—Ö–æ–¥–∏–º –ü–ï–†–í–´–ô –ø–µ—Ä–µ—Ö–æ–¥ –≤ "–ì–æ—Ç–æ–≤–∞ –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ"
for entry in sorted(history_data, key=lambda x: x.start_date):
    if entry.status == "–ì–æ—Ç–æ–≤–∞ –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ":
        target_entry = entry
        break  # –ë–µ—Ä–µ–º –ø–µ—Ä–≤—ã–π
```

–õ–æ–≥–∏–∫–∞ –±–µ—Ä–µ—Ç –ü–ï–†–í–´–ô –ø–µ—Ä–µ—Ö–æ–¥ –≤ —Ü–µ–ª–µ–≤–æ–π —Å—Ç–∞—Ç—É—Å. –ù–æ –∑–∞–¥–∞—á–∞ –º–æ–∂–µ—Ç:
1. –ü–µ—Ä–µ–π—Ç–∏ –≤ "–ì–æ—Ç–æ–≤–∞ –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ" 2025-01-10
2. –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ "–í —Ä–∞–±–æ—Ç–µ" 2025-01-15
3. –°–Ω–æ–≤–∞ –ø–µ—Ä–µ–π—Ç–∏ –≤ "–ì–æ—Ç–æ–≤–∞ –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ" 2025-01-20

**–¢–µ–∫—É—â–µ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:** TTD —Å—á–∏—Ç–∞–µ—Ç—Å—è –¥–æ 2025-01-10 (–ø–µ—Ä–≤–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥–∞)

**–í–æ–ø—Ä–æ—Å:** –≠—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ —Å –±–∏–∑–Ω–µ—Å-—Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è?

**–í–∞—Ä–∏–∞–Ω—Ç—ã:**
- **–ë—Ä–∞—Ç—å –ø–µ—Ä–≤—ã–π –ø–µ—Ä–µ—Ö–æ–¥** (—Ç–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è) - –∑–∞–¥–∞—á–∞ –≤–ø–µ—Ä–≤—ã–µ —Å—Ç–∞–ª–∞ –≥–æ—Ç–æ–≤–æ–π
- **–ë—Ä–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –ø–µ—Ä–µ—Ö–æ–¥** - –∑–∞–¥–∞—á–∞ –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ —Å—Ç–∞–ª–∞ –≥–æ—Ç–æ–≤–æ–π
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ** - –ø–æ–∑–≤–æ–ª–∏—Ç—å –≤—ã–±–∏—Ä–∞—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—É—â–µ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∏ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –µ—Å–ª–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã.

---

### 4. –ü—Ä–æ–±–ª–µ–º–∞ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –∑–∞–¥–∞—á –ø–æ –ø–µ—Ä–∏–æ–¥–∞–º –≤ task_details_csv

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `generate_time_to_market_report.py`, —Å—Ç—Ä–æ–∫–∏ 343-377

**–ü—Ä–æ–±–ª–µ–º–∞:**
```python
# –°—Ç—Ä–æ–∫–∏ 343-346
all_tasks_in_quarter = {
    task.key: task for task in ttd_tasks + ttm_tasks
}

# –°—Ç—Ä–æ–∫–∏ 354-363: –¥–ª—è –ö–ê–ñ–î–û–ô –∑–∞–¥–∞—á–∏ –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è –û–ë–ê TTD –∏ TTM
ttd = self.metrics_service.calculate_time_to_delivery(...)
ttm = self.metrics_service.calculate_time_to_market(...)
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**

1. **–ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø–µ—Ä–∏–æ–¥–∞–º:**
   - –ó–∞–¥–∞—á–∞ –ø–æ–ø–∞–ª–∞ –≤ Q1 –ø–æ TTD –ø–µ—Ä–µ—Ö–æ–¥—É (2025-02-15)
   - –ù–æ –µ–µ TTM –ø–µ—Ä–µ—Ö–æ–¥ –±—ã–ª –≤ Q2 (2025-05-20)
   - –í CSV –¥–ª—è Q1 —É —ç—Ç–æ–π –∑–∞–¥–∞—á–∏ –±—É–¥–µ—Ç –∏ TTD, –∏ TTM, —Ö–æ—Ç—è TTM –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –¥—Ä—É–≥–æ–º—É –∫–≤–∞—Ä—Ç–∞–ª—É

2. **–ü—É—Ç–∞–Ω–∏—Ü–∞ –≤ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö:**
   - –ù–µ—è—Å–Ω–æ, –∫–∞–∫–∞—è –º–µ—Ç—Ä–∏–∫–∞ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –∫–∞–∫–æ–º—É –ø–µ—Ä–∏–æ–¥—É
   - TTM –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞—Å—Å—á–∏—Ç–∞–Ω –¥–ª—è –∑–∞–¥–∞—á–∏, –∫–æ—Ç–æ—Ä–∞—è –µ—â–µ –Ω–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –≤ —Ç–µ–∫—É—â–µ–º –∫–≤–∞—Ä—Ç–∞–ª–µ

**–ü—Ä–∏–º–µ—Ä:**
```csv
–ê–≤—Ç–æ—Ä,–ö–æ–º–∞–Ω–¥–∞,–ö–ª—é—á –∑–∞–¥–∞—á–∏,–ù–∞–∑–≤–∞–Ω–∏–µ,TTD,TTM,Tail,–ü–∞—É–∑–∞,–ö–≤–∞—Ä—Ç–∞–ª
–ò–≤–∞–Ω–æ–≤,Team A,CPO-100,Task 1,10,50,,2,2025.Q1

–ü—Ä–æ–±–ª–µ–º–∞: TTD=10 –¥–Ω–µ–π –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ Q1, –Ω–æ TTM=50 –¥–Ω–µ–π - —ç—Ç–æ –æ—Ç —Å–æ–∑–¥–∞–Ω–∏—è –¥–æ Done,
–∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–∏–∑–æ—à–µ–ª –≤ Q2. –ü–æ–ª—É—á–∞–µ—Ç—Å—è –ø—É—Ç–∞–Ω–∏—Ü–∞!
```

**–†–µ—à–µ–Ω–∏–µ:**
–î–æ–±–∞–≤–∏—Ç—å –∫–æ–ª–æ–Ω–∫–∏ —Å —è–≤–Ω—ã–º —É–∫–∞–∑–∞–Ω–∏–µ–º, –≤ –∫–∞–∫–æ–º –∫–≤–∞—Ä—Ç–∞–ª–µ –ø—Ä–æ–∏–∑–æ—à–µ–ª –ø–µ—Ä–µ—Ö–æ–¥:

```python
task_details.append({
    "–ê–≤—Ç–æ—Ä": task.author,
    "–ö–æ–º–∞–Ω–¥–∞": task.team,
    "–ö–ª—é—á –∑–∞–¥–∞—á–∏": task.key,
    "–ù–∞–∑–≤–∞–Ω–∏–µ": task.summary,
    "TTD": ttd if ttd is not None else "",
    "TTM": ttm if ttm is not None else "",
    "Tail": tail if tail is not None else "",
    "–ü–∞—É–∑–∞": pause_time if pause_time is not None else "",
    "–ö–≤–∞—Ä—Ç–∞–ª": quarter.name,
    "TTD –≤ —ç—Ç–æ–º –∫–≤–∞—Ä—Ç–∞–ª–µ": task.key in [t.key for t in ttd_tasks],  # NEW
    "TTM –≤ —ç—Ç–æ–º –∫–≤–∞—Ä—Ç–∞–ª–µ": task.key in [t.key for t in ttm_tasks],  # NEW
})
```

–ò–ª–∏ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ: –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—É—é –º–µ—Ç—Ä–∏–∫—É –¥–ª—è –∫–≤–∞—Ä—Ç–∞–ª–∞.

---

## ‚ö†Ô∏è –°–†–ï–î–ù–ò–ï –ü–†–û–ë–õ–ï–ú–´

### 5. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞—Ç –≤ –∏—Å—Ç–æ—Ä–∏–∏

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `metrics_service.py`, pause time –º–µ—Ç–æ–¥—ã

**–ü—Ä–æ–±–ª–µ–º–∞:**
–ù–µ—Ç —è–≤–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏, —á—Ç–æ –¥–∞—Ç—ã –≤ –∏—Å—Ç–æ—Ä–∏–∏ –∏–¥—É—Ç –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ –∏ –Ω–µ –ø–µ—Ä–µ—Å–µ–∫–∞—é—Ç—Å—è.

**–í–æ–∑–º–æ–∂–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:**
```python
history = [
    StatusHistoryEntry("New", "New", datetime(2024, 1, 1), None),
    StatusHistoryEntry("In Progress", "In Progress", datetime(2024, 1, 10), None),
    StatusHistoryEntry("–ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ", "–ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ", datetime(2024, 1, 5), None),  # –î–∞—Ç–∞ —Ä–∞–Ω—å—à–µ!
]
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ä–∞—Å—á–µ—Ç pause time
- –í–æ–∑–º–æ–∂–Ω—ã–µ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
- –ù–µ—è–≤–Ω—ã–µ –æ—à–∏–±–∫–∏ –≤ –¥–∞–Ω–Ω—ã—Ö

**–†–µ—à–µ–Ω–∏–µ:**
–î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤ –Ω–∞—á–∞–ª–µ –º–µ—Ç–æ–¥–æ–≤ —Ä–∞—Å—á–µ—Ç–∞:

```python
def _validate_history_dates(self, history_data: List[StatusHistoryEntry]) -> bool:
    """Validate that history dates are in correct order."""
    sorted_history = sorted(history_data, key=lambda x: x.start_date)
    for i in range(len(sorted_history) - 1):
        if sorted_history[i].start_date > sorted_history[i + 1].start_date:
            logger.error(f"History dates are not in order: {sorted_history[i].start_date} > {sorted_history[i + 1].start_date}")
            return False
    return True
```

---

### 6. –ù–µ—è–≤–Ω–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –ø–æ—Ä—è–¥–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `data_service.py`, —Å—Ç—Ä–æ–∫–∏ 184-193

**–ü—Ä–æ–±–ª–µ–º–∞:**
```python
history_query = (
    self.db.query(...)
    .filter(TrackerTaskHistory.task_id == task_id)
    .order_by(TrackerTaskHistory.start_date)  # –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ start_date
)
```

–ò—Å—Ç–æ—Ä–∏—è —Å–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –≤ SQL, –Ω–æ –ø–æ—Ç–æ–º –≤ Python –µ—â–µ —Ä–∞–∑ —Å–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –≤–æ –º–Ω–æ–≥–∏—Ö –º–µ—Å—Ç–∞—Ö:
```python
sorted_history = sorted(history_data, key=lambda x: x.start_date)
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –ò–∑–±—ã—Ç–æ—á–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ + –Ω–µ—Ç –≥–∞—Ä–∞–Ω—Ç–∏–∏, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –∏–∑ –ë–î –≤—Å–µ–≥–¥–∞ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã.

**–†–µ—à–µ–Ω–∏–µ:**
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤ –ë–î –µ—Å—Ç—å –∏–Ω–¥–µ–∫—Å –Ω–∞ `(task_id, start_date)`
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ç—Ä–∞–∫—Ç, —á—Ç–æ `get_task_history` –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –£–±—Ä–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω—É—é —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É –≤ –º–µ—Ç–æ–¥–∞—Ö, –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ —É–∂–µ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã

---

## üí° –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û –£–õ–£–ß–®–ï–ù–ò–Æ

### 7. –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫—É "–í—Ä–µ–º—è –≤ —Ä–∞–±–æ—Ç–µ" (Active Time)

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:**
–ü–æ–º–∏–º–æ TTD/TTM, –ø–æ–ª–µ–∑–Ω–æ –∑–Ω–∞—Ç—å "—á–∏—Å—Ç–æ–µ" –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã:

```python
active_time = ttm - pause_time
```

–≠—Ç–æ –ø–æ–∫–∞–∂–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è, –ø–æ—Ç—Ä–∞—á–µ–Ω–Ω–æ–µ –Ω–∞ –∑–∞–¥–∞—á—É.

---

### 8. –î–æ–±–∞–≤–∏—Ç—å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é "–≤–æ—Ä–æ–Ω–∫–∏" –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:**
–î–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–≤–∞—Ä—Ç–∞–ª–∞ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å, —Å–∫–æ–ª—å–∫–æ –∑–∞–¥–∞—á:
- –°–æ–∑–¥–∞–Ω–æ
- –ü–µ—Ä–µ—à–ª–æ –≤ "–ì–æ—Ç–æ–≤–∞ –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ"
- –ó–∞–≤–µ—Ä—à–µ–Ω–æ

–≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç —É–≤–∏–¥–µ—Ç—å "—É–∑–∫–∏–µ –º–µ—Å—Ç–∞" –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ.

---

### 9. –î–æ–±–∞–≤–∏—Ç—å –¥–µ—Ç–µ–∫—Ü–∏—é "–∑–∞—Å—Ç—Ä—è–≤—à–∏—Ö" –∑–∞–¥–∞—á

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:**
–ó–∞–¥–∞—á–∏, –∫–æ—Ç–æ—Ä—ã–µ:
- –î–æ–ª–≥–æ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –æ–¥–Ω–æ–º —Å—Ç–∞—Ç—É—Å–µ (> X –¥–Ω–µ–π)
- –ò–º–µ—é—Ç –∞–Ω–æ–º–∞–ª—å–Ω–æ –±–æ–ª—å—à–æ–µ TTD/TTM (> 2 * p85)

–ü–æ–º–µ—á–∞—Ç—å –≤ –æ—Ç—á–µ—Ç–µ –∫–∞–∫ —Ç—Ä–µ–±—É—é—â–∏–µ –≤–Ω–∏–º–∞–Ω–∏—è.

---

### 10. –£–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É edge cases

**–¢–µ–∫—É—â–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:**

1. **–ó–∞–¥–∞—á–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –≤ –ø–∞—É–∑–µ:**
```python
history = [
    StatusHistoryEntry("New", "New", datetime(2024, 1, 1), None),
    StatusHistoryEntry("–ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ", "–ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ", datetime(2024, 1, 5), None),
    StatusHistoryEntry("Done", "Done", datetime(2024, 1, 10), None),
]
# –ß—Ç–æ –¥–µ–ª–∞—Ç—å? –ó–∞—Å—á–∏—Ç—ã–≤–∞—Ç—å –ª–∏ –ø–∞—É–∑—É?
```

2. **–ó–∞–¥–∞—á–∞ —Å–æ–∑–¥–∞–Ω–∞ –≤ –ø–∞—É–∑–µ:**
```python
history = [
    StatusHistoryEntry("–ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ", "–ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ", datetime(2024, 1, 1), None),
    StatusHistoryEntry("In Progress", "In Progress", datetime(2024, 1, 5), None),
]
# –ü—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ –≤—ã—á–∏—Ç–∞—Ç—å –≤—Ä–µ–º—è –ø–∞—É–∑—ã —Å –º–æ–º–µ–Ω—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è?
```

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∏ –¥–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è —ç—Ç–∏—Ö —Å–ª—É—á–∞–µ–≤.

---

## üìä –ò–¢–û–ì–û–í–ê–Ø –¢–ê–ë–õ–ò–¶–ê –ü–†–ò–û–†–ò–¢–ï–¢–û–í

| # | –ü—Ä–æ–±–ª–µ–º–∞ | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å | –°–ª–æ–∂–Ω–æ—Å—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|---|----------|-------------|----------------------|-----------|
| 1 | –†–∞—Å—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –≤ —Ä–∞—Å—á–µ—Ç–µ Pause Time | –í–´–°–û–ö–ê–Ø | –°—Ä–µ–¥–Ω—è—è | üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô |
| 2 | –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø–æ–¥—Å—á–µ—Ç total_tasks | –í–´–°–û–ö–ê–Ø | –°—Ä–µ–¥–Ω—è—è | üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô |
| 3 | –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã –≤ —Å—Ç–∞—Ç—É—Å | –°–†–ï–î–ù–Ø–Ø | –ù–∏–∑–∫–∞—è | üü° –°–†–ï–î–ù–ò–ô |
| 4 | –ü—Ä–æ–±–ª–µ–º–∞ —Å task_details_csv | –°–†–ï–î–ù–Ø–Ø | –ù–∏–∑–∫–∞—è | üü° –°–†–ï–î–ù–ò–ô |
| 5 | –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞—Ç | –ù–ò–ó–ö–ê–Ø | –ù–∏–∑–∫–∞—è | üü¢ –ù–ò–ó–ö–ò–ô |
| 6 | –ò–∑–±—ã—Ç–æ—á–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ | –ù–ò–ó–ö–ê–Ø | –ù–∏–∑–∫–∞—è | üü¢ –ù–ò–ó–ö–ò–ô |

---

## üîß –ü–õ–ê–ù –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### –≠—Ç–∞–ø 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã (1-2 –Ω–µ–¥–µ–ª–∏)
1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ä–∞—Å—á–µ—Ç Pause Time –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
2. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø–æ–¥—Å—á–µ—Ç total_tasks
3. –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏

### –≠—Ç–∞–ø 2: –°—Ä–µ–¥–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã (1 –Ω–µ–¥–µ–ª—è)
4. –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–µ—Ä–µ—Ö–æ–¥–∞—Ö
5. –£–ª—É—á—à–∏—Ç—å task_details_csv —Å —è–≤–Ω—ã–º–∏ –º–∞—Ä–∫–µ—Ä–∞–º–∏ –ø–µ—Ä–∏–æ–¥–æ–≤

### –≠—Ç–∞–ø 3: –£–ª—É—á—à–µ–Ω–∏—è (–ø–æ –∂–µ–ª–∞–Ω–∏—é)
6. –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –¥–∞—Ç
7. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É
8. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏

---

## üìù –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

–û—Å–Ω–æ–≤–Ω—ã–µ –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∏–∑—ä—è–Ω—ã —Å–≤—è–∑–∞–Ω—ã —Å:
1. **–ù–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å—é** –º–µ–∂–¥—É –º–µ—Ç–æ–¥–∞–º–∏ —Ä–∞—Å—á–µ—Ç–∞ pause time
2. **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ–º** –∑–∞–¥–∞—á –≤ –ø–æ–¥—Å—á–µ—Ç–µ total_tasks
3. **–ù–µ—è–≤–Ω–æ—Å—Ç—å—é** —Å–≤—è–∑–∏ –∑–∞–¥–∞—á —Å –ø–µ—Ä–∏–æ–¥–∞–º–∏ –≤ –¥–µ—Ç–∞–ª—å–Ω—ã—Ö –æ—Ç—á–µ—Ç–∞—Ö

–≠—Ç–∏ –ø—Ä–æ–±–ª–µ–º—ã –º–æ–≥—É—Ç –ø—Ä–∏–≤–æ–¥–∏—Ç—å –∫ **–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏** –¥–∞–Ω–Ω—ã—Ö –∏ **–∏—Å–∫–∞–∂–µ–Ω–∏—é –º–µ—Ç—Ä–∏–∫** –≤ –æ—Ç—á–µ—Ç–∞—Ö.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã #1 –∏ #2, –∑–∞—Ç–µ–º —É–ª—É—á—à–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –∏ –¥–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è edge cases.
